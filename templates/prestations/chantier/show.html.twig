{# templates/prestations/chantier/show.html.twig #}
{% extends 'base.html.twig' %}

{# ----------------- Données venant du contrôleur -----------------
   - cat   : A, F, B1, C1 ou G
   - title : "CACES® R482 - Catégorie X"
----------------------------------------------------------------- #}

{% block title %}{{ title }} – DP Formation{% endblock %}

{# --- Config complète par catégorie --- #}
{% set pages = {
  'A': {
    hero_src:   asset('images/presta.jpg'),
    hero_src2x: asset('images/presta@2x.jpg'),
    resume:       'Maîtrisez la conduite des engins de la catégorie A (chargeuses / pelles compactes).',
    description:  "
Engins compacts inférieur à 6 tonnes


Objectifs de la formation :

- Connaître la réglementation et appliquer les règles de sécurité liées à l’utilisation des engins de chantier
- Comprendre la technologie des engins, les utiliser en sécurité et maîtriser les manœuvres spécifiques selon la catégorie


Pré-requis :

- Maîtrise de la langue française
- Connaissance des calculs de base (addition, soustraction, etc...)
- Être âgé de 18 ans minimum


Effectif :

- De 1 à 6 participants maximum


Moyens pédagogiques mis à disposition par DP Formation :

- Ordinateur et vidéo-projecteur
- Supports de cours et contenus vidéo
- Engins de chantier de différentes catégories
- Plateforme logistique conforme aux exigences du référentiel CACES® R482


Équipements nécessaires :
(Si nécessaire, DP Formation peut fournir une partie du matériel, dans la limite des stocks disponibles, hors chaussures de sécurité.)

- Chaussures de sécurité
- Casque
- Gants
- Gilet réfléchissant


Contenu théorique :

- Bases de la réglementation applicable aux engins
- Documents à présenter lors d’un contrôle
- Rôle des organismes de prévention (IT, CRAM, OPPBTP, etc...)
- Rôles et responsabilités : chef d’équipe, chef de chantier, conducteur de travaux
- Principaux types d’engins et leurs caractéristiques
- Fonctionnement des organes de service et dispositifs de sécurité
- Principaux risques : renversement, heurts, réseaux enterrés ou aériens, énergie mise en œuvre
- Règles de conduite, circulation, stationnement et gestuelle de commandement
- Dispositions générales de sécurité
- Distances de sécurité avec les conducteurs électriques


Contenu pratique (exemple) :

- Prise de poste et vérifications de sécurité
- Circulation à vide et en charge, sur différents types de sols
- Prise, transport et dépose de charges
- Manœuvres de précision sur aire de travail
- Stationnement et fin de poste


Contenu pratique :

- Contrôle visuel de l’état de l’engin (pneus, flexibles, fissures, cassures)
- Vérification du bon fonctionnement des dispositifs de sécurité
- Circulation en marche avant / arrière, virages, pentes et différents types de sols
- Utilisation correcte des avertisseurs sonores et respect des règles de circulation
- Réalisation des tâches propres à la catégorie de l’engin
- Conduite adaptée aux conditions d’environnement (encombrement, virage, visibilité…)
- Maîtrise des manœuvres avec précision et souplesse
- Fin de poste : stationnement et consignation de l’engin
- Chargement et déchargement sur porte-engin (si option ou catégorie 10)
- Opérations d’entretien de premier niveau
- Vérification des niveaux
- Compte rendu à la hiérarchie


Sanction :

- Évaluations théorique et pratique
- Délivrance d’un CACES® R482 catégorie A en cas de réussite


Validation (selon le référentiel CACES® R482) :

- Évaluation théorique
- Évaluation pratique : un parcours pratique par catégorie

",
    programme_url: 'https://www.francecompetences.fr/recherche/rs/5081/',
    tarifs: {
      inter: 'à partir de 100€',
      intra: 'sur devis'
    },
    infos: {
      'Durée'   : '2 à 3 jours selon niveau',
      'Lieu'    : 'DP Formation Saint-Quentin ou sur site client',
      'Public'  : 'Conducteurs d’engins, personnels de chantier…',
      'Validité': '10 ans (référentiel R482)'
    }
  },

  'F': {
    hero_src:   asset('images/presta.jpg'),
    hero_src2x: asset('images/presta@2x.jpg'),
    resume:       'Conduite en sécurité des chariots télescopiques – catégorie F.',
    description:  "
Chariot de manutention tout-terrain

Objectifs de la formation :

- Connaître la réglementation et appliquer les règles de sécurité liées à l’utilisation des engins de chantier
- Comprendre la technologie des engins, les utiliser en sécurité et maîtriser les manœuvres spécifiques selon la catégorie


Pré-requis :

- Maîtrise de la langue française
- Connaissance des calculs de base (addition, soustraction, etc...)
- Être âgé de 18 ans minimum


Effectif :

- De 1 à 6 participants maximum


Moyens pédagogiques mis à disposition par DP Formation :

- Ordinateur et vidéo-projecteur
- Supports de cours et contenus vidéo
- Engins de chantier de différentes catégories
- Plateforme logistique conforme aux exigences du référentiel CACES® R482


Équipements nécessaires :
(Si nécessaire, DP Formation peut fournir une partie du matériel, dans la limite des stocks disponibles, hors chaussures de sécurité.)

- Chaussures de sécurité
- Casque
- Gants
- Gilet réfléchissant


Contenu théorique :

- Bases de la réglementation applicable aux engins
- Documents à présenter lors d’un contrôle
- Rôle des organismes de prévention (IT, CRAM, OPPBTP, etc...)
- Rôles et responsabilités : chef d’équipe, chef de chantier, conducteur de travaux
- Principaux types d’engins et leurs caractéristiques
- Fonctionnement des organes de service et dispositifs de sécurité
- Principaux risques : renversement, heurts, réseaux enterrés ou aériens, énergie mise en œuvre
- Règles de conduite, circulation, stationnement et gestuelle de commandement
- Dispositions générales de sécurité
- Distances de sécurité avec les conducteurs électriques


Contenu pratique (exemple) :

- Prise de poste et vérifications de sécurité
- Circulation à vide et en charge, sur différents types de sols
- Prise, transport et dépose de charges
- Manœuvres de précision sur aire de travail
- Stationnement et fin de poste


Contenu pratique :

- Contrôle visuel de l’état de l’engin (pneus, flexibles, fissures, cassures)
- Vérification du bon fonctionnement des dispositifs de sécurité
- Circulation en marche avant / arrière, virages, pentes et différents types de sols
- Utilisation correcte des avertisseurs sonores et respect des règles de circulation
- Réalisation des tâches propres à la catégorie de l’engin
- Conduite adaptée aux conditions d’environnement (encombrement, virage, visibilité…)
- Maîtrise des manœuvres avec précision et souplesse
- Fin de poste : stationnement et consignation de l’engin
- Chargement et déchargement sur porte-engin (si option ou catégorie 10)
- Opérations d’entretien de premier niveau
- Vérification des niveaux
- Compte rendu à la hiérarchie


Sanction :

- Évaluations théorique et pratique
- Délivrance d’un CACES® R482 catégorie A en cas de réussite


Validation (selon le référentiel CACES® R482) :

- Évaluation théorique
- Évaluation pratique : un parcours pratique par catégorie

",
    programme_url: 'https://www.francecompetences.fr/recherche/rs/5101/',
    tarifs: {
      inter: 'à partir de 100€',
      intra: 'sur devis'
    },
    infos: {
      'Durée'   : '2 à 3 jours',
      'Lieu'    : 'DP Formation Saint-Quentin ou sur site client',
      'Public'  : 'Caristes, personnels de chantier utilisant des télescopiques',
      'Validité': '10 ans'
    }
  },

  'B1': {
    hero_src:   asset('images/presta.jpg'),
    hero_src2x: asset('images/presta@2x.jpg'),
    resume:       'Formation à la conduite des tracteurs et petits engins de chantier.',
    description:  "
Engins d'extraction à déplacement séquentiel supérieux à 6 tonnes

Objectifs de la formation :

- Connaître la réglementation et appliquer les règles de sécurité liées à l’utilisation des engins de chantier
- Comprendre la technologie des engins, les utiliser en sécurité et maîtriser les manœuvres spécifiques selon la catégorie


Pré-requis :

- Maîtrise de la langue française
- Connaissance des calculs de base (addition, soustraction, etc...)
- Être âgé de 18 ans minimum


Effectif :

- De 1 à 6 participants maximum


Moyens pédagogiques mis à disposition par DP Formation :

- Ordinateur et vidéo-projecteur
- Supports de cours et contenus vidéo
- Engins de chantier de différentes catégories
- Plateforme logistique conforme aux exigences du référentiel CACES® R482


Équipements nécessaires :
(Si nécessaire, DP Formation peut fournir une partie du matériel, dans la limite des stocks disponibles, hors chaussures de sécurité.)

- Chaussures de sécurité
- Casque
- Gants
- Gilet réfléchissant


Contenu théorique :

- Bases de la réglementation applicable aux engins
- Documents à présenter lors d’un contrôle
- Rôle des organismes de prévention (IT, CRAM, OPPBTP, etc...)
- Rôles et responsabilités : chef d’équipe, chef de chantier, conducteur de travaux
- Principaux types d’engins et leurs caractéristiques
- Fonctionnement des organes de service et dispositifs de sécurité
- Principaux risques : renversement, heurts, réseaux enterrés ou aériens, énergie mise en œuvre
- Règles de conduite, circulation, stationnement et gestuelle de commandement
- Dispositions générales de sécurité
- Distances de sécurité avec les conducteurs électriques


Contenu pratique (exemple) :

- Prise de poste et vérifications de sécurité
- Circulation à vide et en charge, sur différents types de sols
- Prise, transport et dépose de charges
- Manœuvres de précision sur aire de travail
- Stationnement et fin de poste


Contenu pratique :

- Contrôle visuel de l’état de l’engin (pneus, flexibles, fissures, cassures)
- Vérification du bon fonctionnement des dispositifs de sécurité
- Circulation en marche avant / arrière, virages, pentes et différents types de sols
- Utilisation correcte des avertisseurs sonores et respect des règles de circulation
- Réalisation des tâches propres à la catégorie de l’engin
- Conduite adaptée aux conditions d’environnement (encombrement, virage, visibilité…)
- Maîtrise des manœuvres avec précision et souplesse
- Fin de poste : stationnement et consignation de l’engin
- Chargement et déchargement sur porte-engin (si option ou catégorie 10)
- Opérations d’entretien de premier niveau
- Vérification des niveaux
- Compte rendu à la hiérarchie


Sanction :

- Évaluations théorique et pratique
- Délivrance d’un CACES® R482 catégorie A en cas de réussite


Validation (selon le référentiel CACES® R482) :

- Évaluation théorique
- Évaluation pratique : un parcours pratique par catégorie

",
    programme_url: 'https://www.francecompetences.fr/recherche/rs/5087/',
    tarifs: {
      inter: 'à partir de 100€',
      intra: 'sur devis'
    },
    infos: {
      'Durée'   : '2 à 3 jours',
      'Lieu'    : 'DP Formation Saint-Quentin ou sur site client',
      'Public'  : 'Conducteurs d’engins légers, personnels de maintenance…',
      'Validité': '10 ans'
    }
  },

  'C1': {
    hero_src:   asset('images/presta.jpg'),
    hero_src2x: asset('images/presta@2x.jpg'),
    resume:       'Maîtrisez la conduite des niveleuses et bulldozers.',
    description:  "
Engins de chargement à déplacement alternatif supérieur à 6 tonnes


Objectifs de la formation :

- Connaître la réglementation et appliquer les règles de sécurité liées à l’utilisation des engins de chantier
- Comprendre la technologie des engins, les utiliser en sécurité et maîtriser les manœuvres spécifiques selon la catégorie


Pré-requis :

- Maîtrise de la langue française
- Connaissance des calculs de base (addition, soustraction, etc...)
- Être âgé de 18 ans minimum


Effectif :

- De 1 à 6 participants maximum


Moyens pédagogiques mis à disposition par DP Formation :

- Ordinateur et vidéo-projecteur
- Supports de cours et contenus vidéo
- Engins de chantier de différentes catégories
- Plateforme logistique conforme aux exigences du référentiel CACES® R482


Équipements nécessaires :
(Si nécessaire, DP Formation peut fournir une partie du matériel, dans la limite des stocks disponibles, hors chaussures de sécurité.)

- Chaussures de sécurité
- Casque
- Gants
- Gilet réfléchissant


Contenu théorique :

- Bases de la réglementation applicable aux engins
- Documents à présenter lors d’un contrôle
- Rôle des organismes de prévention (IT, CRAM, OPPBTP, etc...)
- Rôles et responsabilités : chef d’équipe, chef de chantier, conducteur de travaux
- Principaux types d’engins et leurs caractéristiques
- Fonctionnement des organes de service et dispositifs de sécurité
- Principaux risques : renversement, heurts, réseaux enterrés ou aériens, énergie mise en œuvre
- Règles de conduite, circulation, stationnement et gestuelle de commandement
- Dispositions générales de sécurité
- Distances de sécurité avec les conducteurs électriques


Contenu pratique (exemple) :

- Prise de poste et vérifications de sécurité
- Circulation à vide et en charge, sur différents types de sols
- Prise, transport et dépose de charges
- Manœuvres de précision sur aire de travail
- Stationnement et fin de poste


Contenu pratique :

- Contrôle visuel de l’état de l’engin (pneus, flexibles, fissures, cassures)
- Vérification du bon fonctionnement des dispositifs de sécurité
- Circulation en marche avant / arrière, virages, pentes et différents types de sols
- Utilisation correcte des avertisseurs sonores et respect des règles de circulation
- Réalisation des tâches propres à la catégorie de l’engin
- Conduite adaptée aux conditions d’environnement (encombrement, virage, visibilité…)
- Maîtrise des manœuvres avec précision et souplesse
- Fin de poste : stationnement et consignation de l’engin
- Chargement et déchargement sur porte-engin (si option ou catégorie 10)
- Opérations d’entretien de premier niveau
- Vérification des niveaux
- Compte rendu à la hiérarchie


Sanction :

- Évaluations théorique et pratique
- Délivrance d’un CACES® R482 catégorie A en cas de réussite


Validation (selon le référentiel CACES® R482) :

- Évaluation théorique
- Évaluation pratique : un parcours pratique par catégorie

",
    programme_url: 'https://www.francecompetences.fr/recherche/rs/5123/',
    tarifs: {
      inter: 'à partir de 100€',
      intra: 'sur devis'
    },
    infos: {
      'Durée'   : '3 jours',
      'Lieu'    : 'DP Formation Saint-Quentin ou sur site client',
      'Public'  : 'Conducteurs d’engins de terrassement, chefs de chantier…',
      'Validité': '10 ans'
    }
  },

  'G': {
    hero_src:   asset('images/presta.jpg'),
    hero_src2x: asset('images/presta@2x.jpg'),
    resume:       'Engins de chantier hors-route spécifiques – catégorie G.',
    description:  "
Conduite des engins hors production 

Objectifs de la formation :

- Connaître la réglementation et appliquer les règles de sécurité liées à l’utilisation des engins de chantier
- Comprendre la technologie des engins, les utiliser en sécurité et maîtriser les manœuvres spécifiques selon la catégorie


Pré-requis :

- Maîtrise de la langue française
- Connaissance des calculs de base (addition, soustraction, etc...)
- Être âgé de 18 ans minimum


Effectif :

- De 1 à 6 participants maximum


Moyens pédagogiques mis à disposition par DP Formation :

- Ordinateur et vidéo-projecteur
- Supports de cours et contenus vidéo
- Engins de chantier de différentes catégories
- Plateforme logistique conforme aux exigences du référentiel CACES® R482


Équipements nécessaires :
(Si nécessaire, DP Formation peut fournir une partie du matériel, dans la limite des stocks disponibles, hors chaussures de sécurité.)

- Chaussures de sécurité
- Casque
- Gants
- Gilet réfléchissant


Contenu théorique :

- Bases de la réglementation applicable aux engins
- Documents à présenter lors d’un contrôle
- Rôle des organismes de prévention (IT, CRAM, OPPBTP, etc...)
- Rôles et responsabilités : chef d’équipe, chef de chantier, conducteur de travaux
- Principaux types d’engins et leurs caractéristiques
- Fonctionnement des organes de service et dispositifs de sécurité
- Principaux risques : renversement, heurts, réseaux enterrés ou aériens, énergie mise en œuvre
- Règles de conduite, circulation, stationnement et gestuelle de commandement
- Dispositions générales de sécurité
- Distances de sécurité avec les conducteurs électriques


Contenu pratique (exemple) :

- Prise de poste et vérifications de sécurité
- Circulation à vide et en charge, sur différents types de sols
- Prise, transport et dépose de charges
- Manœuvres de précision sur aire de travail
- Stationnement et fin de poste


Contenu pratique :

- Contrôle visuel de l’état de l’engin (pneus, flexibles, fissures, cassures)
- Vérification du bon fonctionnement des dispositifs de sécurité
- Circulation en marche avant / arrière, virages, pentes et différents types de sols
- Utilisation correcte des avertisseurs sonores et respect des règles de circulation
- Réalisation des tâches propres à la catégorie de l’engin
- Conduite adaptée aux conditions d’environnement (encombrement, virage, visibilité…)
- Maîtrise des manœuvres avec précision et souplesse
- Fin de poste : stationnement et consignation de l’engin
- Chargement et déchargement sur porte-engin (si option ou catégorie 10)
- Opérations d’entretien de premier niveau
- Vérification des niveaux
- Compte rendu à la hiérarchie


Sanction :

- Évaluations théorique et pratique
- Délivrance d’un CACES® R482 catégorie A en cas de réussite


Validation (selon le référentiel CACES® R482) :

- Évaluation théorique
- Évaluation pratique : un parcours pratique par catégorie

",
    programme_url: 'https://www.francecompetences.fr/recherche/rs/5103/',
    tarifs: {
      inter: 'à partir de 100€',
      intra: 'sur devis'
    },
    infos: {
      'Durée'   : '2 à 3 jours',
      'Lieu'    : 'DP Formation Saint-Quentin ou sur site client',
      'Public'  : 'Conducteurs amenés à utiliser des engins spécifiques',
      'Validité': '10 ans'
    }
  }
} %}

{# Sélectionne la bonne config (par défaut A si cat inconnu) #}
{% set page = pages[cat] ?? pages['A'] %}

{# Hero commun basé sur la catégorie #}
{% set HERO_REMOTE = page.hero_src %}
{% set HERO_LOCAL  = page.hero_src2x ?? page.hero_src %}

{% block body %}

{# ================= HERO (parallax 60vh) ================= #}
<section id="heroScroll" class="relative min-h-[60vh]">
  <div id="heroViewport" class="sticky top-0 h-[60vh] overflow-hidden">
    <img id="heroImg"
         src="{{ HERO_REMOTE }}"
         srcset="{{ HERO_REMOTE }} 1x, {{ HERO_LOCAL }} 2x"
         alt="{{ title }}"
         class="absolute inset-0 h-full w-full object-cover"
         style="object-position:50% 0%; transition:object-position 180ms ease-out; will-change:object-position;"
         onerror="this.onerror=null;this.src='{{ HERO_LOCAL }}';"
         loading="eager" fetchpriority="high" />

    <div class="absolute inset-0 bg-blue-600/40 mix-blend-multiply"></div>
    <div class="absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-[#ECF5FF]"></div>

    <div class="relative z-10 flex h-full items-center">
      <div class="mx-auto w-full max-w-7xl px-4 sm:px-6 lg:px-8">
        <div class="max-w-3xl">
          <h1 class="text-3xl font-bold sm:text-4xl md:text-5xl">
            {{ title }}
          </h1>
          <p class="mt-3 text-base text-white/80 sm:text-lg">
            {{ page.resume }}
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

{# ================= CONTENU ================= #}
<section class="bg-[#ECF5FF] py-12 text-slate-900">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">

    {# ---- Ligne du haut : Infos pratiques + Tarifs ---- #}
    <div class="grid grid-cols-1 gap-6 md:grid-cols-2">

      {# Infos pratiques #}
      <article class="rounded-2xl bg-white ring-1 ring-slate-200 p-6 shadow-sm">
        <h2 class="text-lg font-bold">Infos pratiques</h2>
        <ul class="mt-4 space-y-3 text-sm">
          {% for label, value in page.infos %}
            <li class="flex items-start gap-3">
              <span class="mt-1 inline-block h-2 w-2 rounded-full bg-blue-600"></span>
              <p><span class="font-semibold">{{ label }} :</span> {{ value }}</p>
            </li>
          {% endfor %}
        </ul>
      </article>

      {# Tarifs #}
      <aside class="rounded-2xl bg-white ring-1 ring-slate-200 p-6 shadow-sm">
        <h2 class="text-lg font-bold">Tarif de formation</h2>

        <dl class="mt-4 space-y-3 text-sm">
          <div class="flex items-center justify-between">
            <dt class="text-slate-700">inter-entreprises :</dt>
            <dd class="font-semibold">{{ page.tarifs.inter }}</dd>
          </div>
          <div class="flex items-center justify-between">
            <dt class="text-slate-700">intra-entreprise :</dt>
            <dd class="font-semibold">{{ page.tarifs.intra }}</dd>
          </div>
        </dl>

        <div class="mt-5">
          <a href="{{ path('app_home', {'_fragment': 'reservation'}) }}"
             class="inline-flex w-full items-center justify-center rounded-lg bg-[#1d4ed8] px-4 py-2 text-sm font-semibold text-white shadow hover:bg-[#1b45c3] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
            Réserver cette formation
          </a>
        </div>
      </aside>
    </div>

    {# ---- Description (en dessous) ---- #}
    <div class="mt-6 rounded-2xl bg-white ring-1 ring-slate-200 p-6 shadow-sm">
      <h2 class="text-lg font-bold">Description de la formation</h2>
      <div class="prose prose-sm mt-4 max-w-none text-slate-800">
        <p style="white-space:pre-line">{{ page.description|raw }}</p>
      </div>

      <div class="mt-4">
        <a href="{{ page.programme_url }}"
           class="inline-flex items-center rounded-lg bg-[#1d4ed8] px-4 py-2 text-sm font-semibold text-white shadow hover:bg-[#1b45c3] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
          Fiche RS
        </a>
      </div>
    </div>

    {# ---- Bouton retour ---- #}
    <div class="mt-10 text-center">
      <a href="{{ path('app_formations_chantier') }}"
         class="inline-flex items-center gap-2 rounded-xl bg-[#0000FF] px-4 py-2 text-white text-sm font-semibold shadow hover:brightness-110 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
        ← Retour “Chantier”
      </a>
    </div>

  </div>
</section>
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script>
    // Parallax smooth, comme sur les autres pages
    (function () {
      const wrapper  = document.getElementById('heroScroll');
      const viewport = document.getElementById('heroViewport');
      const img      = document.getElementById('heroImg');
      if (!wrapper || !viewport || !img) return;

      let curr = 0, target = 0, rafId = null;

      function computeTarget() {
        const start = wrapper.getBoundingClientRect().top + window.scrollY;
        const range = Math.max(1, viewport.offsetHeight);
        const y     = window.scrollY - start;
        const pRaw  = Math.min(Math.max(y / range, 0), 1);
        target      = Math.min(pRaw, 0.97);
        tick();
      }

      function tick() {
        if (rafId) return;
        rafId = requestAnimationFrame(function animate() {
          rafId = null;
          curr += (target - curr) * 0.12;
          if (Math.abs(target - curr) < 0.001) {
            curr = target;
          } else {
            rafId = requestAnimationFrame(animate);
          }
          img.style.objectPosition = `50% ${Math.round(curr * 100)}%`;
        });
      }

      computeTarget();
      window.addEventListener('scroll', computeTarget, { passive: true });
      window.addEventListener('resize', computeTarget);
    })();
  </script>
{% endblock %}
